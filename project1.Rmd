---
title: "Project 1"
author: "Hien Bui, Ana Martinez, Bryanna Partida"
date: "2025-04-01"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
# Load necessary libraries
library(dplyr)
library(geosphere)
library(kableExtra)
```


```{r}
# Read the datasets
confirmed_df <- read.csv("time_series_covid19_confirmed_global.csv")
deaths_df <- read.csv("time_series_covid19_deaths_global.csv")

#summary(confirmed_df)
#summary(deaths_df)
```

## **Objective 1:Origin**
*Private Diagnostic Laboratories*
```{r}
#finding columns for the first day
confirmed_first_day <- confirmed_df %>%
  select(`Province.State`, `Country.Region`, X1.22.20)

#then the maximum number of confirmed cases on the first day
max_confirmed <- max(confirmed_first_day$X1.22.20, na.rm = TRUE)

#filter the rows with the maximum confirmed cases
origin_confirmed <- confirmed_first_day %>%
  filter(X1.22.20 == max_confirmed)

print("Area with the most confirmed cases on 2020-01-22:")
print(origin_confirmed)
```
*Global Health Union*
```{r}
#Now we do it for deaths
deaths_first_day <- deaths_df %>%
  select(`Province.State`, `Country.Region`, X1.22.20)

max_deaths <- max(deaths_first_day$X1.22.20, na.rm = TRUE)

origin_deaths <- deaths_first_day %>%
  filter(X1.22.20 == max_deaths)

print("Area with the most deaths on 2020-01-22:")
print(origin_deaths)
```
*Origin*
```{r}
#writing prediction of the origin
predicted_origin_confirmed_province<-origin_confirmed$`Province.State`
predicted_origin_confirmed_country <-origin_confirmed$`Country.Region`
predicted_origin_deaths_province <- "Hubei"
predicted_origin_deaths_country <- "China"

if (predicted_origin_confirmed_province == predicted_origin_deaths_province &&
    predicted_origin_confirmed_country == predicted_origin_deaths_country) {
  print(paste("Based on the greatest number of confirmations and deaths on January 22, 2020,",
              predicted_origin_confirmed_province, ",", predicted_origin_confirmed_country,
              "is predicted to be the origin of COVID-19."))
} else {
  print(paste("The area with the most confirmed cases on January 22, 2020, was:",
              predicted_origin_confirmed_province, ",", predicted_origin_confirmed_country))
  print(paste("The area with the most deaths on January 22, 2020, was:",
              predicted_origin_deaths_province, ",", predicted_origin_deaths_country))
  print("Based on these findings, we can infer the potential origin.")
}
```

  ***We used these datasets of Covid-19 of confirmations and deaths to searched for the earliest recorded day to determine the day 1 of the infection. After we found that January 22,2020 was the first day, we proceeded to figure out the number of confirmed cases and deaths on that day. It was Hubei province of China that had the highest number of confirmed cases and death. And with that information, we were able to determine that Hubei was most likely the origin of the Covid-19 according to this datasets.***

## **Objective 2: Most recent area**

```{r}

#making variables to store the most recent first case information
date_columns <- names(confirmed_df)[5:ncol(confirmed_df)]
most_recent_first_case_date <- as.Date("2020-01-21") 
#and initializing date before the first recorded date
most_recent_first_case_province <- NA
most_recent_first_case_country <- NA

#loop through each row of the confirmed_df and the date columns
for (i in 1:nrow(confirmed_df)) {
  province <- confirmed_df$`Province.State`[i]
  country <- confirmed_df$`Country.Region`[i]

  first_case_found <- FALSE
  first_case_date <- NA


  for (date_col in date_columns) {
    cases <- confirmed_df[i, date_col]
    if (!is.na(cases) && cases > 0) {
      first_case_date <- as.Date(gsub("X", "", date_col), format = "%m.%d.%y")
      first_case_found <- TRUE
      break 
#break from the inner loop once the first case is found for this location
    }
  }

#updating the most recent first case if a later date is found
  if (first_case_found && first_case_date > most_recent_first_case_date) {
    most_recent_first_case_date <- first_case_date
    most_recent_first_case_province <- province
    most_recent_first_case_country <- country
  }
}

print("The most recent area to have a first confirmed case:")
print(paste("Province/State:", most_recent_first_case_province))
print(paste("Country/Region:", most_recent_first_case_country))
print(paste("Date:", format(most_recent_first_case_date, "%Y-%m-%d")))
```

